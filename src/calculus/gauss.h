
///
/// @file gauss.h Roots and weights for Gaussian quadrature
///

#ifndef THEORETICA_GAUSS_H
#define THEORETICA_GAUSS_H

#include "../core/constants.h"


namespace theoretica {

	/// @namespace theoretica::tables Tabulated values
	namespace tables {


		// Legendre

		static real legendre_roots_2[2] = {
			-0.577350269189625764506505,
			0.577350269189625764506505
		};

		static real legendre_weights_2[2] = {
			1, 1
		};

		static real legendre_roots_4[4] = {
			-0.861136311594052575194101,
			-0.339981043584856264846549,
			0.339981043584856264738129,
			0.861136311594052575194101
		};

		static real legendre_weights_4[4] = {
			0.347854845137453857491878,
			0.652145154862546142535227,
			0.652145154862546142643647,
			0.347854845137453857491878
		};

		static real legendre_roots_8[8] = {
			-0.960289856497536231715127,
			-0.796666477413626739621007,
			-0.525532409916328985884527,
			-0.183434642495649804990214,
			0.183434642495649804936004,
			0.525532409916328985884527,
			0.796666477413626739621007,
			0.960289856497536231715127
		};

		static real legendre_weights_8[8] = {
			0.101228536290376258828787,
			0.222381034453374470260959,
			0.313706645877887287419484,
			0.362683783378361982948669,
			0.362683783378361982948669,
			0.313706645877887287419484,
			0.222381034453374470260959,
			0.101228536290376258828787
		};

		static real legendre_roots_16[16] = {
			-0.989400934991649929186111,
			-0.944575023073232580589787,
			-0.865631202387831746901999,
			-0.755404408355003026897482,
			-0.617876244402643747097217,
			-0.458016777657227386105678,
			-0.281603550779258913257935,
			-0.0950125098376374401876535,
			0.0950125098376374401605484,
			0.281603550779258913203725,
			0.458016777657227386701989,
			0.617876244402643747097217,
			0.755404408355003026897482,
			0.865631202387831746901999,
			0.944575023073232565953058,
			0.989400934991649929186111
		};

		static real legendre_weights_16[16] = {
			0.0271524594117540951122847,
			0.0622535239386478849447004,
			0.0951585116824928647197876,
			0.124628971255533850669866,
			0.149595988816576744480109,
			0.169156519395002539321907,
			0.182603415044923588682552,
			0.189450610455068496273891,
			0.189450610455068496300996,
			0.182603415044923588967155,
			0.169156519395002538020865,
			0.149595988816576744480109,
			0.124628971255533850669866,
			0.0951585116824928647197876,
			0.0622535239386479161324535,
			0.0271524594117540951122847
		};


		// static real legendre_roots_32[32] = {
		// 	-0.997263861857754357,
		// 	-0.985611511513568054,
		// 	-0.964762255607148099,
		// 	-0.934906075922520294,
		// 	-0.896321155773302245,
		// 	-0.849367613730439807,
		// 	-0.794483795968033725,
		// 	-0.732182118740292232,
		// 	-0.663044266930186403,
		// 	-0.587715757240765377,
		// 	-0.506899908932229955,
		// 	-0.421351276130635362,
		// 	-0.331868602282127647,
		// 	-0.239287362252137079,
		// 	-0.144471961582796489,
		// 	-0.0483076656877383144,
		// 	0.0483076656877383143,
		// 	0.144471961582796489,
		// 	0.239287362252137079,
		// 	0.331868602282127647,
		// 	0.421351276130635377,
		// 	0.506899908932229671,
		// 	0.587715757240770706,
		// 	0.663044266930235729,
		// 	0.732182118740292232,
		// 	0.794483795968033725,
		// 	0.849367613730718411,
		// 	0.896321155773564136,
		// 	0.934906075922520294,
		// 	0.964762255601060239,
		// 	0.985611511524600353,
		// 	0.997263861854734067
		// };

		// static real legendre_weights_32[32] = {
		// 	0.00701860999392926347,
		// 	0.0162743947373905706,
		// 	0.0253920653532744276,
		// 	0.0342738628469387911,
		// 	0.0428358980323415326,
		// 	0.0509980592402000867,
		// 	0.058684093484179235,
		// 	0.0658222227755954119,
		// 	0.0723457941089436714,
		// 	0.0781938957870706759,
		// 	0.0833119242269451505,
		// 	0.0876520930044041812,
		// 	0.0911738786957638425,
		// 	0.0938443990808045674,
		// 	0.0956387200792748594,
		// 	0.0965400885147278006,
		// 	0.0965400885147278006,
		// 	0.0956387200792748594,
		// 	0.0938443990808045684,
		// 	0.0911738786957638982,
		// 	0.0876520930044041227,
		// 	0.0833119242269470546,
		// 	0.0781938957870331485,
		// 	0.0723457941087007004,
		// 	0.0658222227755954119,
		// 	0.058684093484179235,
		// 	0.0509980592608559001,
		// 	0.0428358980523077302,
		// 	0.0342738628469387911,
		// 	0.0253920653400316176,
		// 	0.0162743947410909622,
		// 	0.00701861000167079658
		// };


		// Laguerre

		static real laguerre_roots_2[2] = {
			0.58578643762690546732,
			3.4142135623730945322
		};

		static real laguerre_weights_2[2] = {
			0.85355339059327000202,
			0.14644660940672634871
		};


		static real laguerre_roots_4[4] = {
			0.32254768961939191742,
			1.7457611011583463777,
			4.5366202969211275316,
			9.3950709123011330332
		};

		static real laguerre_weights_4[4] = {
			0.60315410434164023839,
			0.35741869243780005017,
			0.03888790851500541948,
			0.00053929470556132749637
		};


		static real laguerre_roots_8[8] = {
			0.17027963230510124502,
			0.90370177679937967218,
			2.2510866298661306928,
			4.2667001702876592626,
			7.0459054023934658056,
			10.758516010180995295,
			15.740678641278004193,
			22.863131736889263833
		};

		static real laguerre_weights_8[8] = {
			0.36918858934162849121,
			0.41878678081434484077,
			0.17579498663717180432,
			0.033343492261215595242,
			0.0027945362352256706928,
			9.0765087733582173847e-005,
			8.4857467162725295329e-007,
			1.0480011748715107818e-009
		};


		static real laguerre_roots_16[16] = {
			0.087649410478928189153,
			0.46269632891508138072,
			1.1410577748312272208,
			2.1292836450983810438,
			3.4370866338932063403,
			5.0780186145497663115,
			7.0703385350482545854,
			9.4383143363918924219,
			12.214223368866159374,
			15.441527368781641486,
			19.180156856752924456,
			23.51590569399238859,
			28.578729742881671998,
			34.583398702286930866,
			41.940452647688152288,
			51.701160339543346826
		};

		static real laguerre_weights_16[16] = {
			0.20615171495777392289,
			0.33105785495087120126,
			0.26579577764421131011,
			0.13629693429637680541,
			0.047328928694125499268,
			0.011299900080339313299,
			0.0018490709435266595795,
			0.00020427191530818007586,
			1.4844586873978733152e-005,
			6.8283193308651186878e-007,
			1.8810248410831411265e-008,
			2.8623502429707047297e-010,
			2.1270790332192899185e-012,
			6.2979670025300090354e-015,
			5.050473700032298015e-018,
			4.1614623703730629937e-022
		};


		// static real laguerre_roots_32[32] = {
		// 	0.044489365833267011,
		// 	0.234526109519618539,
		// 	0.576884629301886451,
		// 	1.07244875381781767,
		// 	1.72240877644464141,
		// 	2.5283367064258563,
		// 	3.49221327302131325,
		// 	4.61645676975569182,
		// 	5.90395850414047563,
		// 	7.35812673333756388,
		// 	8.98294092348948808,
		// 	10.7830186364013656,
		// 	12.7636979676761235,
		// 	14.9311398191526476,
		// 	17.2924541383928158,
		// 	19.8558611910129986,
		// 	22.6308889040839813,
		// 	25.6286336181699067,
		// 	28.8621069783300356,
		// 	32.3466141037895016,
		// 	36.100521128267354,
		// 	40.1456853785788052,
		// 	44.5092488156708649,
		// 	49.224356908714456,
		// 	54.3337560654101594,
		// 	59.8924916866906756,
		// 	65.9753871954886819,
		// 	72.6876252778472645,
		// 	80.1874477181112173,
		// 	88.7353402694851827,
		// 	98.8295428877922159,
		// 	111.751398096967571
		// };

		// static real laguerre_weights_32[32] = {
		// 	0.109218341952386137,
		// 	0.210443107938813038,
		// 	0.235213229669848072,
		// 	0.195903335972884265,
		// 	0.129983786286040199,
		// 	0.0705786238658405061,
		// 	0.0317609125089989109,
		// 	0.0119182148348745182,
		// 	0.00373881629489589733,
		// 	0.000980803306535576062,
		// 	0.000214864917751981034,
		// 	3.92034206103571888e-005,
		// 	5.93454059516695936e-006,
		// 	7.41640645299713078e-007,
		// 	7.60456031573260172e-008,
		// 	6.35062241661272548e-009,
		// 	4.28135708999582244e-010,
		// 	2.30597552923540949e-011,
		// 	9.79924414517649313e-013,
		// 	3.2380680680252195e-014,
		// 	8.17148099873044724e-016,
		// 	1.54239788872784004e-017,
		// 	2.11956026780819121e-019,
		// 	2.05483228732982048e-021,
		// 	1.34689072746826191e-023,
		// 	5.66198872814423236e-026,
		// 	1.41851331349461079e-028,
		// 	1.91339353090951936e-031,
		// 	1.19224521402153189e-034,
		// 	2.67151237211542113e-038,
		// 	1.33861691530279821e-042,
		// 	4.51053619610604169e-048
		// };


		// Hermite


		static real hermite_roots_2[2] = {
			-0.707106781186547524,
			0.707106781186547524
		};

		static real hermite_weights_2[2] = {
			0.886226925452757941,
			0.886226925452757941
		};


		static real hermite_roots_4[4] = {
			-1.65068012388578456,
			-0.52464762327529032,
			0.52464762327529032,
			1.65068012388578456
		};

		static real hermite_weights_4[4] = {
			0.08131283544724517,
			0.80491409000551277,
			0.80491409000551277,
			0.08131283544724517
		};


		static real hermite_roots_8[8] = {
			-2.93063742025724402,
			-1.98165675669584293,
			-1.15719371244678019,
			-0.381186990207322117,
			0.381186990207322117,
			1.15719371244678019,
			1.98165675669584293,
			2.93063742025724402,
		};

		static real hermite_weights_8[8] = {
			0.0001996040722113676,
			0.0170779830074134741,
			0.207802325814891863,
			0.66114701255824124,
			0.66114701255824124,
			0.207802325814891863,
			0.0170779830074134741,
			0.0001996040722113676
		};


		static real hermite_roots_16[16] = {
			-4.68873893930581836,
			-3.86944790486012269,
			-3.17699916197995602,
			-2.54620215784748137,
			-1.95178799091625398,
			-1.3802585391988808,
			-0.822951449144655892,
			-0.273481046138152452,
			0.273481046138152453,
			0.822951449144655892,
			1.3802585391988808,
			1.95178799091625398,
			2.54620215784748136,
			3.17699916197995602,
			3.86944790486012269,
			4.68873893930581836
		};

		static real hermite_weights_16[16] = {
			2.65480747401118205e-010,
			2.32098084486521081e-007,
			2.71186009253788177e-005,
			0.000932284008624180443,
			0.0128803115355099723,
			0.0838100413989858226,
			0.280647458528533652,
			0.5079294790166137,
			0.5079294790166137,
			0.280647458528533652,
			0.0838100413989858228,
			0.0128803115355099723,
			0.000932284008624180486,
			2.71186009253788177e-005,
			2.32098084486521081e-007,
			2.65480747401118205e-010
		};


		// Weight formula is unstable for n = 32
		// static real hermite_roots_32[32] = {
		// 	-7.12581390983072783,
		// 	-6.40949814926966118,
		// 	-5.81222594951589073,
		// 	-5.27555098651589635,
		// 	-4.77716450350258118,
		// 	-4.30554795335118818,
		// 	-3.85375548547141306,
		// 	-3.41716749281857802,
		// 	-2.99249082500238047,
		// 	-2.57724953773231757,
		// 	-2.16949918360611214,
		// 	-1.76765410946320166,
		// 	-1.37037641095287183,
		// 	-0.976500463589682838,
		// 	-0.584978765435932451,
		// 	-0.194840741569399328,
		// 	0.194840741569399328,
		// 	0.584978765435932452,
		// 	0.976500463589682838,
		// 	1.37037641095287184,
		// 	1.76765410946320166,
		// 	2.16949918360611214,
		// 	2.57724953773231639,
		// 	2.99249082500238047,
		// 	3.41716749281857802,
		// 	3.85375548547145482,
		// 	4.30554795335118818,
		// 	4.77716450350258118,
		// 	5.2755509865158684,
		// 	5.81222594951589073,
		// 	6.40949814926966118,
		// 	7.12581390983072765
		// };

	}

}

#endif
